<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ©ã‚¯ã¡ã‚“æ‰€å¾—ç¨è¨ˆç®—ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4f46e5;
            --primary-light: #6366f1;
            --primary-dark: #4338ca;
            --primary-bg: #eef2ff;
            --success: #22c55e;
            --warning: #f59e0b;
            --error: #ef4444;
            --text: #1f2937;
            --text-light: #6b7280;
            --border: #e5e7eb;
            --bg-main: #f9fafb;
            --bg-card: #ffffff;
            --input-bg: #f3f4f6;
            --input-focus-bg: #f8fafc;
            --highlight: #f0f9ff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            background-color: var(--bg-main);
            color: var(--text);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
            display: flex; /* For footer positioning */
            flex-direction: column; /* For footer positioning */
        }

        .container {
            max-width: 900px;
            margin: 20px auto; 
            background-color: var(--bg-card);
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
            padding: 32px;
            flex-grow: 1; /* Allow container to grow and push footer down */
        }

        .header {
            text-align: center;
            margin-bottom: 32px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }

        .header h1 {
            color: var(--primary);
            font-size: 2.25rem;
            margin-bottom: 8px;
        }

        .header p {
            color: var(--text-light);
            font-size: 0.95rem;
            margin-top: 4px; 
        }
        .disclaimer {
            font-size: 0.8rem;
            color: var(--warning); 
            margin-top: 12px;
            padding: 8px;
            background-color: #fffbeb; 
            border: 1px solid var(--warning);
            border-radius: 6px;
            line-height: 1.8; 
        }


        .section {
            background-color: var(--bg-card); 
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid var(--border);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .section-title {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }

        .section-title h2 {
            font-size: 1.25rem;
            color: var(--primary-dark);
            flex-grow: 1;
        }

        .section-title .number-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            font-weight: 600;
            font-size: 0.875rem;
            margin-right: 12px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group:last-child {
            margin-bottom: 0;
        }

        label.input-label, 
        .form-group > label { 
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text);
            font-size: 0.9375rem;
        }

        input[type="number"],
        input[type="text"],
        select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            background-color: var(--input-bg);
            transition: all 0.2s ease;
        }

        input[type="number"]:focus,
        input[type="text"]:focus,
        select:focus {
            border-color: var(--primary-light);
            background-color: var(--input-focus-bg);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
            outline: none;
        }

        input[type="number"]::placeholder,
        input[type="text"]::placeholder {
            color: #aab3c0;
        }

        input[type="radio"] {
            width: 16px;
            height: 16px;
            accent-color: var(--primary);
            opacity: 0;
            position: absolute;
            left: -9999px;
        }

        .radio-group {
            display: flex;
            gap: 16px;
            flex-wrap: wrap; 
        }

        @media (max-width: 480px) {
            .radio-group {
                flex-direction: column;
                gap: 8px;
            }
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 10px 16px;
            background-color: var(--input-bg);
            border-radius: 8px;
            border: 2px solid var(--border);
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative; 
        }
        .radio-option::before { 
            content: '';
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid var(--text-light);
            border-radius: 50%;
            margin-right: 10px;
            background-color: white;
            transition: all 0.2s ease;
        }

        .radio-option input[type="radio"]:checked + .radio-label + span::before, 
        .radio-option.radio-option-selected::before { 
            border-color: var(--primary);
            background-color: var(--primary); 
        }
        
        .radio-option input[type="radio"]:checked + .radio-label + span::after,
        .radio-option.radio-option-selected::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 18px; 
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: white; 
            display: block;
        }


        .radio-option:hover {
            border-color: var(--primary-light);
            background-color: var(--primary-bg);
        }
         .radio-option:hover::before {
            border-color: var(--primary-light);
        }

        .radio-option.radio-option-selected {
            border-color: var(--primary);
            background-color: var(--primary-bg);
        }
         .radio-option.radio-option-selected::before {
            border-color: var(--primary);
        }


        .radio-label {
            font-size: 0.9375rem;
            user-select: none; 
        }

        .help-text {
            font-size: 0.8125rem;
            color: var(--text-light);
            margin-top: 6px;
        }

        .calculate-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 14px 24px;
            font-size: 1.0625rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            display: block;
            margin: 30px auto;
            transition: all 0.2s ease;
            width: 100%;
            max-width: 300px;
            box-shadow: 0 4px 6px rgba(79, 70, 229, 0.2);
        }

        .calculate-btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: 0 6px 10px rgba(79, 70, 229, 0.25);
        }

        .calculate-btn:active {
            transform: translateY(1px);
            box-shadow: 0 2px 4px rgba(79, 70, 229, 0.2);
        }

        .results-container {
            margin-top: 32px;
            padding: 24px;
            background-color: var(--highlight);
            border-radius: 12px;
            border: 1px solid var(--primary-light);
            display: none; 
        }

        .results-title {
            font-size: 1.5rem;
            color: var(--primary-dark);
            margin-bottom: 24px;
            text-align: center;
            padding-bottom: 12px;
            border-bottom: 1px dashed var(--primary-light);
        }

        .result-group {
            margin-bottom: 20px;
            padding-bottom: 8px;
        }
        .result-group:last-of-type {
            margin-bottom: 0; 
        }


        .result-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0; 
            font-size: 0.9375rem;
        }

        .result-row:not(:last-child) {
            border-bottom: 1px solid var(--border);
        }

        .result-label {
            color: var(--text);
        }

        .result-value {
            font-weight: 600;
            color: var(--primary-dark);
        }

        .subtotal-row {
            font-weight: 600;
            background-color: rgba(99, 102, 241, 0.05);
            padding: 10px 8px;
            border-radius: 4px;
            margin-top: 8px; 
        }
        .subtotal-row .result-label, .subtotal-row .result-value {
             color: var(--primary-dark); 
        }


        .important-row {
            font-size: 1.125rem;
            font-weight: 700;
        }

        .important-value {
            color: var(--primary);
        }

        .final-row {
            margin-top: 16px;
            padding: 16px 12px; 
            background-color: var(--primary-bg);
            border-radius: 8px;
            font-size: 1.25rem;
            font-weight: 700;
        }
        .final-row .result-label {
            color: var(--primary-dark);
        }

        .final-value {
            color: var(--primary-dark);
        }

        .note {
            margin-top: 24px;
            font-size: 0.875rem;
            color: var(--text-light);
            text-align: center;
            padding: 12px;
            background-color: var(--bg-main);
            border-radius: 8px;
            line-height: 1.8; 
        }

        .error-message {
            background-color: #fef2f2;
            border: 1px solid #fecaca;
            color: #b91c1c;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 0.9375rem;
            display: none; 
        }


        .input-with-yen {
            position: relative;
        }

        .input-with-yen input {
            padding-right: 40px; 
        }

        .yen-symbol {
            position: absolute;
            right: 14px;
            top: 50%; 
            transform: translateY(-50%); 
            color: var(--text-light);
            pointer-events: none;
            font-size: 0.9375rem;
        }

        .section-emoji {
            display: inline-block;
            margin-right: 8px;
            font-size: 1.25rem;
        }
        
        .required-label::after {
            content: "*";
            color: var(--error);
            margin-left: 4px;
        }

        .contact-banner {
            margin-top: 32px; 
            margin-bottom: 16px; 
            text-align: center; 
        }
        .contact-banner img {
            max-width: 100%; 
            height: auto; 
            border-radius: 8px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.15); 
            transition: transform 0.2s ease-in-out;
        }
        .contact-banner img:hover {
            transform: scale(1.02); 
        }
        .site-footer {
            text-align: center;
            padding: 20px 0;
            margin-top: auto; /* Push footer to the bottom */
            font-size: 0.875rem;
            color: var(--text-light);
            border-top: 1px solid var(--border); /* Optional: add a top border to the footer */
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ãƒ©ã‚¯ã¡ã‚“æ‰€å¾—ç¨è¨ˆç®—ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h1>
            <p>2025å¹´ä»¥é™ã®ç¨åˆ¶ã«å¯¾å¿œï¼ˆå¾©èˆˆç‰¹åˆ¥æ‰€å¾—ç¨2.1%ã‚’å«ã‚€ï¼‰</p>
            <p class="disclaimer">â€»ã“ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯æ¦‚ç®—ã§ã‚ã‚Šã€å®Ÿéš›ã®ç¨é¡ã¨ç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚<br>ã„ã‹ãªã‚‹å ´åˆã«ãŠã„ã¦ã‚‚ã€æœ¬ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆ©ç”¨ã«ã‚ˆã‚Šç”Ÿã˜ãŸæå®³ã«ã¤ã„ã¦ã€<br>ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã‹ã­ã¾ã™ã®ã§ã”äº†æ‰¿ãã ã•ã„ã€‚</p>
        </div>

        <div class="error-message" id="errorMessage"></div>
        
        <div class="section">
            <div class="section-title">
                <span class="number-badge">1</span>
                <h2><span class="section-emoji">ğŸ’¼</span>å£²ä¸Šã¨å¿…è¦çµŒè²»</h2>
            </div>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="income" class="required-label input-label">å£²ä¸Šé‡‘é¡</label>
                    <div class="input-with-yen">
                        <input type="number" id="income" placeholder="ä¾‹: 5000000" required>
                        <span class="yen-symbol">å††</span>
                    </div>
                    <p class="help-text">å£²ä¸Šé‡‘é¡ã‚„çµ¦ä¸åå…¥ãªã©ã®ç·é¡</p>
                </div>
                
                <div class="form-group">
                    <label for="expenses" class="input-label">å¿…è¦çµŒè²»</label>
                    <div class="input-with-yen">
                        <input type="number" id="expenses" placeholder="ä¾‹: 1000000">
                        <span class="yen-symbol">å††</span>
                    </div>
                    <p class="help-text">äº‹æ¥­ã®å ´åˆã¯å¿…è¦çµŒè²»ã€çµ¦ä¸ã®å ´åˆã¯çµ¦ä¸æ‰€å¾—æ§é™¤é¡</p>
                </div>
            </div>
            
            <div class="form-group">
                <label class="input-label">é’è‰²ç”³å‘Šç‰¹åˆ¥æ§é™¤</label>
                <div class="radio-group">
                    <label class="radio-option" id="blueYesLabel">
                        <input type="radio" name="blueReturnDeduction" value="650000" id="blueYes"> 
                        <span class="radio-label">ã‚ã‚Šï¼ˆ65ä¸‡å††ï¼‰</span>
                        <span></span> </label>
                    <label class="radio-option radio-option-selected" id="blueNoLabel">
                        <input type="radio" name="blueReturnDeduction" value="0" id="blueNo" checked> 
                        <span class="radio-label">ãªã—</span>
                        <span></span> </label>
                </div>
                <p class="help-text">é’è‰²ç”³å‘Šã‚’è¡Œã£ã¦ã„ã‚‹å ´åˆã®ã¿é©ç”¨ã•ã‚Œã¾ã™</p>
            </div>
        </div>
        
        <div class="section">
            <div class="section-title">
                <span class="number-badge">2</span>
                <h2><span class="section-emoji">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</span>å®¶æ—æ§‹æˆ</h2>
            </div>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="dependents" class="input-label">æ‰¶é¤Šè¦ªæ—æ•°ï¼ˆ16æ­³ä»¥ä¸Šï¼‰</label>
                    <select id="dependents">
                        <option value="0">0äºº</option>
                        <option value="1">1äºº</option>
                        <option value="2">2äºº</option>
                        <option value="3">3äºº</option>
                        <option value="4">4äºº</option>
                        <option value="5">5äººä»¥ä¸Š</option>
                    </select>
                    <p class="help-text">ä¸€èˆ¬æ‰¶é¤Šè¦ªæ—ï¼š38ä¸‡å††/äºº</p>
                </div>
                
                <div class="form-group">
                    <label for="under16" class="input-label">æ‰¶é¤Šè¦ªæ—æ•°ï¼ˆ16æ­³æœªæº€ï¼‰</label>
                    <select id="under16">
                        <option value="0">0äºº</option>
                        <option value="1">1äºº</option>
                        <option value="2">2äºº</option>
                        <option value="3">3äºº</option>
                        <option value="4">4äºº</option>
                        <option value="5">5äººä»¥ä¸Š</option>
                    </select>
                    <p class="help-text">16æ­³æœªæº€ã®æ‰¶é¤Šè¦ªæ—ã¯æ‰€å¾—ç¨ã®æ‰¶é¤Šæ§é™¤ã®å¯¾è±¡å¤–ã§ã™ï¼ˆä½æ°‘ç¨ã«ã¯å½±éŸ¿ã—ã¾ã™ï¼‰</p>
                </div>
            </div>
            
            <div class="form-group">
                <label class="input-label">é…å¶è€…ã®æœ‰ç„¡</label>
                <div class="radio-group">
                    <label class="radio-option" id="spouseYesLabel">
                        <input type="radio" name="spouse" value="yes" id="spouseYes"> 
                        <span class="radio-label">ã‚ã‚Š</span>
                        <span></span>
                    </label>
                    <label class="radio-option radio-option-selected" id="spouseNoLabel">
                        <input type="radio" name="spouse" value="no" id="spouseNo" checked> 
                        <span class="radio-label">ãªã—</span>
                        <span></span>
                    </label>
                </div>
            </div>
            
            <div class="form-group" id="spouseDeductionContainer" style="display: none;">
                <label for="spouseDeduction" class="input-label">é…å¶è€…æ§é™¤ï¼é…å¶è€…ç‰¹åˆ¥æ§é™¤ã®é¡</label>
                <div class="input-with-yen">
                    <input type="number" id="spouseDeduction" placeholder="ä¾‹: 380000">
                    <span class="yen-symbol">å††</span>
                </div>
                <p class="help-text">ç´ç¨è€…æœ¬äººã¨é…å¶è€…ã®æ‰€å¾—ã«å¿œã˜ã¦å¤‰å‹•ï¼ˆæœ€å¤§38ä¸‡å††ï¼‰ã€‚<br>ã“ã“ã§ã¯é…å¶è€…ã®åå…¥103ä¸‡å††ä»¥ä¸‹ã¨ä»®å®šã—ã€38ä¸‡å††ã‚’è‡ªå‹•å…¥åŠ›ã—ã¦ã„ã¾ã™ã€‚</p>
            </div>
        </div>
        
        <div class="section">
            <div class="section-title">
                <span class="number-badge">3</span>
                <h2><span class="section-emoji">ğŸ“</span>å„ç¨®æ‰€å¾—æ§é™¤</h2>
            </div>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="socialInsurance" class="input-label">ç¤¾ä¼šä¿é™ºæ–™æ§é™¤</label>
                    <div class="input-with-yen">
                        <input type="number" id="socialInsurance" placeholder="ä¾‹: 700000">
                        <span class="yen-symbol">å††</span>
                    </div>
                    <p class="help-text">å¥åº·ä¿é™ºã€å¹´é‡‘ã€é›‡ç”¨ä¿é™ºç­‰ã®æ”¯æ‰•é¡åˆè¨ˆ</p>
                </div>
                
                <div class="form-group">
                    <label for="lifeInsurance" class="input-label">ç”Ÿå‘½ä¿é™ºæ–™æ§é™¤</label>
                    <div class="input-with-yen">
                        <input type="number" id="lifeInsurance" placeholder="ä¾‹: 50000">
                        <span class="yen-symbol">å††</span>
                    </div>
                    <p class="help-text">ç”Ÿå‘½ä¿é™ºæ–™æ§é™¤ã®é©ç”¨é¡ï¼ˆæœ€å¤§12ä¸‡å††ï¼‰</p>
                </div>
                
                <div class="form-group">
                    <label for="medicalExpenses" class="input-label">åŒ»ç™‚è²»æ§é™¤</label>
                    <div class="input-with-yen">
                        <input type="number" id="medicalExpenses" placeholder="ä¾‹: 150000">
                        <span class="yen-symbol">å††</span>
                    </div>
                    <p class="help-text">åŒä¸–å¸¯ã§ã‹ã‹ã£ãŸåŒ»ç™‚è²»ã®åˆè¨ˆé‡‘é¡ï¼ˆã“ã“ã‹ã‚‰10ä¸‡å††ã‚’å¼•ã„ãŸé¡ãŒæ§é™¤å¯¾è±¡ï¼‰</p>
                </div>
                
                <div class="form-group">
                    <label for="smallBusiness" class="input-label">å°è¦æ¨¡ä¼æ¥­å…±æ¸ˆç­‰æ›é‡‘æ§é™¤</label>
                    <div class="input-with-yen">
                        <input type="number" id="smallBusiness" placeholder="ä¾‹: 0">
                        <span class="yen-symbol">å††</span>
                    </div>
                    <p class="help-text">å°è¦æ¨¡ä¼æ¥­å…±æ¸ˆã‚„iDeCoç­‰ã®æ›é‡‘</p>
                </div>
            </div>
            
            <div class="form-group">
                <label for="otherDeduction" class="input-label">ãã®ä»–ã®æ‰€å¾—æ§é™¤</label>
                <div class="input-with-yen">
                    <input type="number" id="otherDeduction" placeholder="ä¾‹: 0">
                        <span class="yen-symbol">å††</span>
                    </div>
                    <p class="help-text">é›‘ææ§é™¤ã€å¯„ä»˜é‡‘æ§é™¤ãªã©ä¸Šè¨˜ä»¥å¤–ã®æ‰€å¾—æ§é™¤åˆè¨ˆ</p>
                </div>
            </div>
            
            <button id="calculateBtn" class="calculate-btn">è¨ˆç®—ã™ã‚‹</button>
            
            <div id="resultsContainer" class="results-container">
                <h3 class="results-title">æ‰€å¾—ç¨ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ</h3>
                
                <div class="result-group">
                    <div class="result-row">
                        <span class="result-label">â‘  å£²ä¸Šé‡‘é¡</span>
                        <span class="result-value" id="resultIncome">0å††</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">â‘¡ å¿…è¦çµŒè²»</span>
                        <span class="result-value" id="resultExpenses">0å††</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">é’è‰²ç”³å‘Šç‰¹åˆ¥æ§é™¤</span>
                        <span class="result-value" id="resultBlueReturn">0å††</span>
                    </div>
                    <div class="result-row subtotal-row">
                        <span class="result-label">æ‰€å¾—é‡‘é¡ (â‘  - â‘¡ - é’è‰²æ§é™¤)</span>
                        <span class="result-value" id="resultTotalIncome">0å††</span>
                    </div>
                </div>
                
                <div class="result-group">
                    <div class="result-row">
                        <span class="result-label">åŸºç¤æ§é™¤</span>
                        <span class="result-value" id="resultBasicDeduction">0å††</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">é…å¶è€…(ç‰¹åˆ¥)æ§é™¤</span>
                        <span class="result-value" id="resultSpouseDeductionCalc">0å††</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">æ‰¶é¤Šæ§é™¤</span>
                        <span class="result-value" id="resultDependentDeduction">0å††</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">ç¤¾ä¼šä¿é™ºæ–™æ§é™¤</span>
                        <span class="result-value" id="resultSocialInsuranceCalc">0å††</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">ç”Ÿå‘½ä¿é™ºæ–™æ§é™¤</span>
                        <span class="result-value" id="resultLifeInsuranceCalc">0å††</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">åŒ»ç™‚è²»æ§é™¤</span>
                        <span class="result-value" id="resultMedicalExpensesCalc">0å††</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">å°è¦æ¨¡ä¼æ¥­å…±æ¸ˆç­‰æ›é‡‘æ§é™¤</span>
                        <span class="result-value" id="resultSmallBusinessCalc">0å††</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">ãã®ä»–ã®æ‰€å¾—æ§é™¤</span>
                        <span class="result-value" id="resultOtherDeductionCalc">0å††</span>
                    </div>
                    <div class="result-row subtotal-row">
                        <span class="result-label">â‘¢ æ‰€å¾—æ§é™¤åˆè¨ˆ</span>
                        <span class="result-value" id="resultTotalDeduction">0å††</span>
                    </div>
                </div>
                
                <div class="result-group">
                    <div class="result-row important-row">
                        <span class="result-label">â‘£ èª²ç¨æ‰€å¾—é‡‘é¡</span>
                        <span class="result-value important-value" id="resultTaxableIncome">0å††</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">é©ç”¨ç¨ç‡</span>
                        <span class="result-value" id="resultTaxRate">0%</span>
                    </div>
                    <div class="result-row important-row">
                        <span class="result-label">â‘¤ æ‰€å¾—ç¨é¡</span>
                        <span class="result-value important-value" id="resultIncomeTax">0å††</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">â‘¥ å¾©èˆˆç‰¹åˆ¥æ‰€å¾—ç¨ (æ‰€å¾—ç¨é¡ Ã— 2.1%)</span>
                        <span class="result-value" id="resultRecoveryTax">0å††</span>
                    </div>
                    <div class="result-row final-row">
                        <span class="result-label">â‘¦ æœ€çµ‚çš„ãªç´ç¨é¡</span>
                        <span class="result-value final-value" id="resultFinalTax">0å††</span>
                    </div>
                </div>
                
                <p class="note">â€» ã“ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯ä¸€èˆ¬çš„ãªã‚±ãƒ¼ã‚¹ã‚’æƒ³å®šã—ãŸæ¦‚ç®—ã§ã‚ã‚Šã€å®Ÿéš›ã®ç¨é¡ã¨ã¯ç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚<br>è©³ç´°ã¯ç¨å‹™ç½²ã‚„ç¨ç†å£«ã«ã”ç›¸è«‡ãã ã•ã„ã€‚</p>
                
                <div class="contact-banner">
                    <a href="https://lin.ee/K8sNswk" target="_blank" rel="noopener noreferrer">
                        <img src="ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚µã‚¤ãƒˆã€€å•ã„åˆã‚ã›ãƒãƒŠãƒ¼.png" alt="ç„¡æ–™ç›¸è«‡ãƒ»å•ã„åˆã‚ã›ãƒãƒŠãƒ¼">
                    </a>
                </div>
            </div>
        </div>
    <footer class="site-footer">
        <p>Â© æ ªå¼ä¼šç¤¾T-STORY</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³é¸æŠã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
            const radioOptions = document.querySelectorAll('.radio-option');
            
            radioOptions.forEach(option => {
                const radio = option.querySelector('input[type="radio"]');
                
                // åˆæœŸçŠ¶æ…‹ã§é¸æŠã•ã‚Œã¦ã„ã‚‹ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨
                if (radio.checked) {
                    option.classList.add('radio-option-selected');
                }

                option.addEventListener('click', function(event) {
                    // ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³è‡ªä½“ã¸ã®ã‚¯ãƒªãƒƒã‚¯ã§ãªã„å ´åˆï¼ˆãƒ©ãƒ™ãƒ«ã‚¯ãƒªãƒƒã‚¯ãªã©ï¼‰ã«ãƒ©ã‚¸ã‚ªã‚’ãƒã‚§ãƒƒã‚¯
                    if (event.target !== radio) {
                         radio.checked = true;
                    }

                    const name = radio.getAttribute('name');
                    const group = document.querySelectorAll(`input[name="${name}"]`);
                    
                    group.forEach(r => {
                        const parentLabel = r.closest('.radio-option');
                        if (parentLabel) {
                            parentLabel.classList.remove('radio-option-selected');
                        }
                    });
                    
                    option.classList.add('radio-option-selected');
                    
                    // é…å¶è€…æ§é™¤ã®å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®è¡¨ç¤º/éè¡¨ç¤ºã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤è¨­å®š
                    if (name === 'spouse') {
                        toggleSpouseDeduction();
                    }
                });
            });
            
            // é…å¶è€…æ§é™¤ã®è¡¨ç¤º/éè¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹é–¢æ•°
            function toggleSpouseDeduction() {
                const spouseYes = document.getElementById('spouseYes');
                const spouseDeductionContainer = document.getElementById('spouseDeductionContainer');
                const spouseDeductionInputEl = document.getElementById('spouseDeduction');
                
                if (spouseYes.checked) {
                    spouseDeductionContainer.style.display = 'block';
                    spouseDeductionInputEl.value = '380000'; // ã€Œã‚ã‚Šã€é¸æŠæ™‚ã«38ä¸‡å††ã‚’è‡ªå‹•å…¥åŠ›
                } else {
                    spouseDeductionContainer.style.display = 'none';
                    spouseDeductionInputEl.value = ''; // éè¡¨ç¤ºæ™‚ã«å€¤ã‚’ã‚¯ãƒªã‚¢
                }
            }
            
            // åˆæœŸè¡¨ç¤ºæ™‚ã®é…å¶è€…æ§é™¤æ¬„ã®çŠ¶æ…‹ã‚’è¨­å®š
            toggleSpouseDeduction();
            
            // æ•°å€¤ã‚’å††è¡¨è¨˜ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã™ã‚‹é–¢æ•°
            function formatCurrency(value) {
                if (isNaN(value)) return "0å††";
                return Math.round(value).toLocaleString('ja-JP') + 'å††';
            }
             function formatPercentage(value) {
                if (isNaN(value)) return "0%";
                return value.toFixed(1) + '%';
            }

            // è¨ˆç®—ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
            document.getElementById('calculateBtn').addEventListener('click', calculateTax);
            
            // æ‰€å¾—ç¨è¨ˆç®—é–¢æ•°
            function calculateTax() {
                // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒªã‚»ãƒƒãƒˆ
                const errorMessage = document.getElementById('errorMessage');
                errorMessage.style.display = 'none';
                errorMessage.textContent = '';
                
                // å…¥åŠ›å€¤ã®å–å¾—ã¨ãƒ‘ãƒ¼ã‚¹
                const income = parseFloat(document.getElementById('income').value) || 0; 
                const expenses = parseFloat(document.getElementById('expenses').value) || 0;
                const blueReturnDeductionValue = parseFloat(document.querySelector('input[name="blueReturnDeduction"]:checked').value) || 0;
                
                const dependents = parseInt(document.getElementById('dependents').value) || 0;
                
                const hasSpouse = document.querySelector('input[name="spouse"]:checked').value === 'yes';
                let spouseDeductionInput = 0;
                if (hasSpouse) {
                    spouseDeductionInput = parseFloat(document.getElementById('spouseDeduction').value) || 0;
                }
                
                const socialInsurance = parseFloat(document.getElementById('socialInsurance').value) || 0;
                const lifeInsuranceInput = parseFloat(document.getElementById('lifeInsurance').value) || 0;
                
                // åŒ»ç™‚è²»æ§é™¤ã®è¨ˆç®— (å…¥åŠ›å€¤ - 10ä¸‡å††ã€ãŸã ã—0æœªæº€ã«ãªã‚‰ãªã„)
                const medicalExpensesTotal = parseFloat(document.getElementById('medicalExpenses').value) || 0;
                const medicalExpensesDeductible = Math.max(0, medicalExpensesTotal - 100000);

                const smallBusinessMutualAid = parseFloat(document.getElementById('smallBusiness').value) || 0;
                const otherDeductionsInput = parseFloat(document.getElementById('otherDeduction').value) || 0;

                // å¿…é ˆé …ç›®ï¼ˆå£²ä¸Šé‡‘é¡ï¼‰ã®ãƒã‚§ãƒƒã‚¯
                if (income <= 0 && document.getElementById('income').value.trim() !== "" && parseFloat(document.getElementById('income').value) <=0 ) {
                } else if (document.getElementById('income').value.trim() === "" || isNaN(parseFloat(document.getElementById('income').value))) {
                     errorMessage.textContent = 'å£²ä¸Šé‡‘é¡ã¯å¿…é ˆé …ç›®ã§ã™ã€‚æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚'; 
                     errorMessage.style.display = 'block';
                     document.getElementById('resultsContainer').style.display = 'none';
                     return;
                }

                // ãã®ä»–ã®å…¥åŠ›å€¤ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆè² ã®å€¤ã®ãƒã‚§ãƒƒã‚¯ï¼‰
                // medicalExpensesTotalã¯è² ã®å€¤ã‚’è¨±å®¹ã—ãªã„ (åŒ»ç™‚è²»ãŒãƒã‚¤ãƒŠã‚¹ã¯ã‚ã‚Šãˆãªã„ãŸã‚)
                if (expenses < 0 || spouseDeductionInput < 0 || socialInsurance < 0 || 
                    lifeInsuranceInput < 0 || medicalExpensesTotal < 0 || smallBusinessMutualAid < 0 || 
                    otherDeductionsInput < 0) {
                    errorMessage.textContent = 'æ§é™¤é¡ç­‰ã«è² ã®æ•°ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚0ä»¥ä¸Šã®æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
                    errorMessage.style.display = 'block';
                    document.getElementById('resultsContainer').style.display = 'none';
                    return;
                }
                
                // ã‚¹ãƒ†ãƒƒãƒ—1: æ‰€å¾—é‡‘é¡ã®è¨ˆç®—
                const incomeBeforeBlueReturn = Math.max(0, income - expenses);
                const calculatedIncome = Math.max(0, incomeBeforeBlueReturn - blueReturnDeductionValue);

                // ã‚¹ãƒ†ãƒƒãƒ—2: å„ç¨®æ‰€å¾—æ§é™¤ã®è¨ˆç®—
                let basicDeduction = 0;
                if (incomeBeforeBlueReturn <= 24000000) {
                    basicDeduction = 480000;
                } else if (incomeBeforeBlueReturn <= 24500000) {
                    basicDeduction = 320000;
                } else if (incomeBeforeBlueReturn <= 25000000) {
                    basicDeduction = 160000;
                } else {
                    basicDeduction = 0;
                }

                const dependentDeductionAmount = dependents * 380000;
                const spouseDeductionAmount = spouseDeductionInput; 
                const lifeInsuranceDeductionAmount = Math.min(lifeInsuranceInput, 120000);

                const totalIncomeDeductions = basicDeduction + 
                                              spouseDeductionAmount + 
                                              dependentDeductionAmount + 
                                              socialInsurance + 
                                              lifeInsuranceDeductionAmount + 
                                              medicalExpensesDeductible + // è¨ˆç®—æ¸ˆã¿ã®æ§é™¤é¡ã‚’ä½¿ç”¨
                                              smallBusinessMutualAid + 
                                              otherDeductionsInput;

                // ã‚¹ãƒ†ãƒƒãƒ—3: èª²ç¨æ‰€å¾—é‡‘é¡ã®è¨ˆç®—
                let taxableIncome = calculatedIncome - totalIncomeDeductions;
                taxableIncome = Math.max(0, taxableIncome); 
                taxableIncome = Math.floor(taxableIncome / 1000) * 1000; 

                // ã‚¹ãƒ†ãƒƒãƒ—4: æ‰€å¾—ç¨é¡ã®è¨ˆç®—ï¼ˆç´¯é€²èª²ç¨ï¼‰ã¨é©ç”¨ç¨ç‡
                let incomeTaxAmount = 0;
                let taxRateDisplay = 0;

                if (taxableIncome <= 1950000) {
                    incomeTaxAmount = taxableIncome * 0.05;
                    taxRateDisplay = 5;
                } else if (taxableIncome <= 3300000) {
                    incomeTaxAmount = taxableIncome * 0.10 - 97500;
                    taxRateDisplay = 10;
                } else if (taxableIncome <= 6950000) {
                    incomeTaxAmount = taxableIncome * 0.20 - 427500;
                    taxRateDisplay = 20;
                } else if (taxableIncome <= 9000000) {
                    incomeTaxAmount = taxableIncome * 0.23 - 636000;
                    taxRateDisplay = 23;
                } else if (taxableIncome <= 18000000) {
                    incomeTaxAmount = taxableIncome * 0.33 - 1536000;
                    taxRateDisplay = 33;
                } else if (taxableIncome <= 40000000) {
                    incomeTaxAmount = taxableIncome * 0.40 - 2796000;
                    taxRateDisplay = 40;
                } else {
                    incomeTaxAmount = taxableIncome * 0.45 - 4796000;
                    taxRateDisplay = 45;
                }
                incomeTaxAmount = Math.max(0, Math.floor(incomeTaxAmount)); 

                // ã‚¹ãƒ†ãƒƒãƒ—5: å¾©èˆˆç‰¹åˆ¥æ‰€å¾—ç¨ã®è¨ˆç®—
                const reconstructionSpecialIncomeTax = Math.floor(incomeTaxAmount * 0.021); 

                // ã‚¹ãƒ†ãƒƒãƒ—6: æœ€çµ‚çš„ãªç´ç¨é¡ã®è¨ˆç®—
                const finalTaxAmountRaw = incomeTaxAmount + reconstructionSpecialIncomeTax;
                const finalTaxAmount = Math.floor(finalTaxAmountRaw / 100) * 100; 

                // çµæœã®è¡¨ç¤º
                document.getElementById('resultIncome').textContent = formatCurrency(income); 
                document.getElementById('resultExpenses').textContent = formatCurrency(expenses);
                document.getElementById('resultBlueReturn').textContent = formatCurrency(blueReturnDeductionValue);
                document.getElementById('resultTotalIncome').textContent = formatCurrency(calculatedIncome);
                
                document.getElementById('resultBasicDeduction').textContent = formatCurrency(basicDeduction);
                document.getElementById('resultSpouseDeductionCalc').textContent = formatCurrency(spouseDeductionAmount);
                document.getElementById('resultDependentDeduction').textContent = formatCurrency(dependentDeductionAmount);
                document.getElementById('resultSocialInsuranceCalc').textContent = formatCurrency(socialInsurance);
                document.getElementById('resultLifeInsuranceCalc').textContent = formatCurrency(lifeInsuranceDeductionAmount);
                document.getElementById('resultMedicalExpensesCalc').textContent = formatCurrency(medicalExpensesDeductible); // è¨ˆç®—å¾Œã®æ§é™¤é¡ã‚’è¡¨ç¤º
                document.getElementById('resultSmallBusinessCalc').textContent = formatCurrency(smallBusinessMutualAid);
                document.getElementById('resultOtherDeductionCalc').textContent = formatCurrency(otherDeductionsInput);
                document.getElementById('resultTotalDeduction').textContent = formatCurrency(totalIncomeDeductions);
                
                document.getElementById('resultTaxableIncome').textContent = formatCurrency(taxableIncome);
                document.getElementById('resultTaxRate').textContent = taxRateDisplay.toFixed(0) + '%'; 
                document.getElementById('resultIncomeTax').textContent = formatCurrency(incomeTaxAmount);
                document.getElementById('resultRecoveryTax').textContent = formatCurrency(reconstructionSpecialIncomeTax);
                document.getElementById('resultFinalTax').textContent = formatCurrency(finalTaxAmount);

                document.getElementById('resultsContainer').style.display = 'block'; 
            }
        });
    </script>
</body>
</html>
